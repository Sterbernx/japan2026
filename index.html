<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>üáØüáµ JAPONIA V11 MIX</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;600&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: '#d4af37',
                        neonGreen: '#39ff14',
                        neonPink: '#ff0055',
                        neonBlue: '#00f2ff',
                        blackBg: '#050505',
                        cardBg: '#121212'
                    },
                    fontFamily: {
                        'teko': ['Teko', 'sans-serif'],
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #fff; -webkit-tap-highlight-color: transparent; }
        
        /* Layout: Mapa 35%, Lista 65% */
        #map-container { position: fixed; top: 0; left: 0; width: 100%; height: 35vh; z-index: 0; border-bottom: 2px solid #333; }
        #map { width: 100%; height: 100%; background: #111; }
        
        #content-scroll { 
            position: fixed; top: 35vh; left: 0; width: 100%; height: 65vh; 
            overflow-y: auto; background: #050505; z-index: 10; 
            padding-bottom: 100px; /* miejsce na footer */
        }

        .leaflet-tile-pane { filter: invert(100%) hue-rotate(180deg) brightness(85%) contrast(110%); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* Ikony */
        .pin-std { background: #000; color: #00f2ff; border: 2px solid #00f2ff; border-radius: 50%; text-align: center; font-weight: bold; font-size: 14px; line-height: 24px; box-shadow: 0 0 8px #00f2ff; }
        .pin-hotel { background: #ff0055; color: #fff; padding: 2px; border-radius: 4px; font-size: 18px; text-align: center; border: 1px solid #fff; z-index: 999; }
    </style>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body x-data="app()" x-init="init()" class="bg-blackBg text-white h-screen w-screen overflow-hidden">

    <div id="map-container">
        <div id="map"></div>
        <div class="absolute top-3 left-3 z-[500] bg-black/80 backdrop-blur px-3 py-1 rounded border border-gray-700">
            <div class="text-[10px] text-gray-400">CEL:</div>
            <div class="text-sm font-bold text-neonBlue" x-text="currentDayTitle"></div>
        </div>
        <button @click="locateMe()" class="absolute bottom-3 right-3 z-[500] bg-black/80 p-2 rounded border border-gray-600 text-xs">üìç Gdzie ja?</button>
    </div>

    <div id="content-scroll">
        <div class="p-3 space-y-4">
            
            <template x-for="day in days" :key="day.id">
                <div class="bg-cardBg rounded-xl overflow-hidden border border-gray-900 shadow-lg transition-all"
                     :class="activeDay === day.id ? 'border-neonBlue ring-1 ring-neonBlue/20' : ''">
                    
                    <div @click="setDay(day)" class="p-4 flex justify-between items-center cursor-pointer bg-gradient-to-r from-cardBg to-black active:bg-gray-900">
                        <div>
                            <div class="font-teko text-2xl text-white leading-none tracking-wide" x-text="day.date"></div>
                            <div class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1" x-text="day.title"></div>
                        </div>
                        <div class="text-right">
                             <div class="text-[10px] text-neonBlue border border-neonBlue/50 px-2 py-0.5 rounded bg-neonBlue/10 mb-1">üöá METRO</div>
                             <div class="text-gray-500 text-xs" :class="activeDay === day.id ? 'rotate-90' : ''">‚û§</div>
                        </div>
                    </div>

                    <div x-show="activeDay === day.id" x-collapse class="bg-black/40 border-t border-gray-800">
                        
                        <div class="p-3 bg-gray-900/50 border-b border-gray-800 text-xs flex items-center gap-2">
                             <span>üöÜ <b>Dojazd:</b></span>
                             <span class="text-gray-300" x-text="day.transport"></span>
                        </div>

                        <template x-for="(task, i) in day.tasks" :key="i">
                            <div class="p-3 border-b border-gray-800/50 last:border-0 relative">
                                <div class="flex gap-3 items-start">
                                    <div class="flex-none w-6 h-6 rounded-full border border-gray-600 flex items-center justify-center text-xs text-gray-400 mt-0.5" x-text="i+1"></div>
                                    <div class="flex-1">
                                        <div class="text-sm font-bold text-gray-200" :class="task.done ? 'line-through opacity-50' : ''" x-text="task.name"></div>
                                        
                                        <div class="mt-2 p-2 rounded border transition-all duration-300"
                                             :class="foodMode === 'cheap' ? 'bg-green-900/20 border-green-800' : 'bg-gold/10 border-gold/30'">
                                            <div class="flex justify-between items-center mb-1">
                                                <span class="text-[9px] font-bold uppercase tracking-wider" 
                                                      :class="foodMode === 'cheap' ? 'text-neonGreen' : 'text-gold'"
                                                      x-text="foodMode === 'cheap' ? 'üå≠ OPCJA TANIA' : 'üíé OPCJA VIP'"></span>
                                            </div>
                                            <div class="text-xs text-gray-300 italic">
                                                <span x-text="foodMode === 'cheap' ? task.cheapFood : task.richFood"></span>
                                            </div>
                                        </div>

                                        <button x-show="task.coords" @click="nav(task.coords)" class="mt-2 text-[10px] text-gray-500 hover:text-white underline">
                                            üìç Prowad≈∫ tam
                                        </button>
                                    </div>
                                    <input type="checkbox" class="accent-neonBlue w-5 h-5 opacity-50 checked:opacity-100" x-model="task.done" @change="save()">
                                </div>
                            </div>
                        </template>

                        <div x-show="day.fun" class="p-3 bg-purple-900/20 border-t border-gray-800 text-xs text-purple-300 italic">
                            üéâ <b>Fun Fact:</b> <span x-text="day.fun"></span>
                         </div>
                    </div>
                </div>
            </template>
            <div class="h-10"></div>
        </div>
    </div>

    <div class="fixed bottom-0 left-0 w-full bg-black/90 backdrop-blur border-t border-gray-800 p-3 z-50">
        <div class="flex justify-center gap-4">
            <button @click="foodMode = 'cheap'" 
                    class="flex-1 py-3 rounded-xl border font-bold text-sm transition-all duration-200"
                    :class="foodMode === 'cheap' ? 'bg-neonGreen text-black border-neonGreen shadow-[0_0_15px_#39ff14]' : 'bg-gray-900 text-gray-500 border-gray-700'">
                üå≠ TANIO
            </button>
            <button @click="foodMode = 'rich'" 
                    class="flex-1 py-3 rounded-xl border font-bold text-sm transition-all duration-200"
                    :class="foodMode === 'rich' ? 'bg-gold text-black border-gold shadow-[0_0_15px_#d4af37]' : 'bg-gray-900 text-gray-500 border-gray-700'">
                üíé NA BOGATO
            </button>
        </div>
        <div class="text-center text-[9px] text-gray-600 mt-1 uppercase tracking-widest">Wybierz bud≈ºet na gastro</div>
    </div>

    <script>
        function app() {
            return {
                map: null,
                layerGroup: null,
                activeDay: 'd1',
                currentDayTitle: 'Asakusa',
                foodMode: 'cheap', // 'cheap' or 'rich'
                
                hotels: {
                    tokyo1: [35.6930, 139.7924], // Galicia
                    kyoto: [35.0080, 135.7700],  // Le Lion
                    tokyo2: [35.6650, 139.8700]  // Tomi
                },

                days: [
                    { 
                        id: 'd1', date: '23.03', title: 'ASAKUSA & UENO', 
                        transport: 'Linia Ginza (Metro)', 
                        fun: 'W Ueno jest ulica Ameyoko - kiedy≈õ czarny rynek, teraz podr√≥bki i jedzenie.',
                        tasks: [
                            { name: 'Sens≈ç-ji Temple', coords: [35.7147, 139.7966], cheapFood: 'Melonpan (ciastko) z budki - 200 JPY', richFood: 'Unagi (Wƒôgorz) w Unatoto - 3000 JPY', done: false },
                            { name: 'Park Ueno', coords: [35.7140, 139.7740], cheapFood: 'Bento z marketu i piknik', richFood: 'Innsyoutei (Kaiseki w parku) - 6000 JPY', done: false },
                            { name: 'Daikoku-yu Onsen', coords: [35.7077, 139.8056], cheapFood: 'Mleko z automatu', richFood: 'Craft Beer w barze obok', done: false }
                        ]
                    },
                    { 
                        id: 'd2', date: '24.03', title: 'CENTRUM & AKIBA', 
                        transport: 'Linia Oedo (do targu) -> Yamanote (Akiba)', 
                        fun: 'W Akibie uwa≈ºajcie na naganiaczki do Maid Cafe. Te na ulicy to czƒôsto scam.',
                        tasks: [
                            { name: 'Tsukiji Market', coords: [35.6654, 139.7706], cheapFood: 'Tamagoyaki (jajko) na patyku - 150 JPY', richFood: 'Sushi Daiwa (Omakase) - 5000+ JPY', done: false },
                            { name: 'Akihabara', coords: [35.7022, 139.7741], cheapFood: 'Go Go Curry (Katsu Curry) - 900 JPY', richFood: 'Yakiniku (Grill) w wie≈ºowcu UDX', done: false },
                            { name: 'Salon Gier SEGA/GIGO', coords: [35.6995, 139.7715], cheapFood: 'Woda z konbini', richFood: 'Wydaj miliony na pluszaki', done: false }
                        ]
                    },
                    { 
                        id: 'd3', date: '25.03', title: 'SHIBUYA & IMPREZA', 
                        transport: 'Linia Yamanote (zielona pƒôtla)',
                        fun: 'Shibuya Meltdown - profil na IG pokazujƒÖcy pijanych salaryman√≥w. Nie bƒÖd≈∫cie nimi.',
                        tasks: [
                            { name: 'Shibuya Crossing', coords: [35.6595, 139.7004], cheapFood: 'Genki Sushi (na ta≈õmie) - taniocha', richFood: 'Kobe Beef Teppanyaki Hakushu', done: false },
                            { name: 'Shibuya Sky', coords: [35.6585, 139.7018], cheapFood: '-', richFood: 'Drink w The Roof (tylko rezerwacja)', done: false },
                            { name: 'Nonbei Yokocho (Picie)', coords: [35.6590, 139.7010], cheapFood: 'Piwo ze sklepu pod mostem', richFood: 'Mikro-bary (wysokie coperto)', done: false }
                        ]
                    },
                    { 
                        id: 'd4', date: '26.03', title: 'NAKAMEGURO CHILL', 
                        transport: 'Linia Hibiya (Metro)',
                        fun: 'To dzielnica hipster√≥w. Du≈ºo vintage shop√≥w.',
                        tasks: [
                            { name: 'Nakameguro (Rzeka)', coords: [35.6443, 139.6990], cheapFood: 'Kawa z Starbucksa', richFood: 'Szampan z truskawkami w kieliszku', done: false },
                            { name: 'Shinjuku Golden Gai', coords: [35.6938, 139.7035], cheapFood: 'Omoide Yokocho (szasz≈Çyki)', richFood: 'Bar Albatross (drinki)', done: false }
                        ]
                    },
                    { 
                        id: 'd5', date: '27.03', title: 'KAMAKURA', 
                        transport: 'PociƒÖg JR Yokosuka Line',
                        fun: 'Uwaga na jastrzƒôbie na pla≈ºy! KradnƒÖ jedzenie z rƒôki.',
                        tasks: [
                            { name: 'Wielki Budda', coords: [35.3168, 139.5361], cheapFood: 'Lody Batatowe', richFood: 'Obiad z widokiem na ocean', done: false },
                            { name: 'Enoshima', coords: [35.3016, 139.4814], cheapFood: 'Tako Senbei (krakers z o≈õmiornicƒÖ)', richFood: 'Shirasu-don w drogiej knajpie', done: false }
                        ]
                    },
                    { 
                        id: 'd6', date: '28.03', title: 'KIOTO GION', 
                        transport: 'Taxi z dworca (z baga≈ºami)',
                        fun: 'Je≈õli widzicie Gejszƒô, nie dotykajcie jej. Serio, sƒÖ mandaty.',
                        tasks: [
                            { name: 'Kiyomizu-dera', coords: [34.9948, 135.7850], cheapFood: 'Ciastko Yatsuhashi (darmowe pr√≥bki)', richFood: 'Tofu Kaiseki (Okutan)', done: false },
                            { name: 'Gion District', coords: [35.0054, 135.7745], cheapFood: 'Ramen w bocznej ulicy', richFood: 'Kolacja z GejszƒÖ (wymaga rezerwacji)', done: false }
                        ]
                    }
                ],

                init() {
                    this.map = L.map('map', {zoomControl: false}).setView([35.693, 139.792], 12);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                        attribution: '', maxZoom: 19
                    }).addTo(this.map);
                    this.layerGroup = L.layerGroup().addTo(this.map);
                    
                    const saved = localStorage.getItem('jp_v11_status');
                    if(saved) {
                        const parsed = JSON.parse(saved);
                        this.days.forEach((d, di) => {
                            if(parsed[di]) d.tasks.forEach((t, ti) => {
                                if(parsed[di].tasks[ti]) t.done = parsed[di].tasks[ti].done;
                            });
                        });
                    }
                    this.setDay(this.days[0]);
                },

                setDay(day) {
                    this.activeDay = day.id;
                    this.currentDayTitle = day.title;
                    this.renderMap(day);
                },

                renderMap(day) {
                    this.layerGroup.clearLayers();
                    const bounds = [];
                    
                    // Hotel Start
                    let hotelCoords = this.hotels.tokyo1;
                    if(day.id === 'd6' || day.id === 'd7' || day.id === 'd9') hotelCoords = this.hotels.kyoto;
                    if(day.id === 'd10') hotelCoords = this.hotels.tokyo2;
                    
                    L.marker(hotelCoords, {icon: L.divIcon({html: 'üè®', className: 'pin-hotel'})}).addTo(this.layerGroup);
                    bounds.push(hotelCoords);

                    // Punkty
                    day.tasks.forEach((t, i) => {
                        if(t.coords) {
                            L.marker(t.coords, {
                                icon: L.divIcon({html: i+1, className: 'pin-std', iconSize: [24,24]})
                            }).addTo(this.layerGroup);
                            bounds.push(t.coords);
                        }
                    });

                    if(bounds.length > 0) {
                        this.map.flyToBounds(bounds, {padding: [50, 50], duration: 1});
                    }
                },

                nav(coords) {
                    window.open(`https://www.google.com/maps/dir/?api=1&destination=${coords[0]},${coords[1]}&travelmode=transit`, '_blank');
                },

                locateMe() {
                    if(navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(p => {
                            L.circleMarker([p.coords.latitude, p.coords.longitude], {radius:8, color:'#39ff14'}).addTo(this.layerGroup);
                            this.map.setView([p.coords.latitude, p.coords.longitude], 14);
                        });
                    }
                },

                save() {
                    localStorage.setItem('jp_v11_status', JSON.stringify(this.days));
                }
            }
        }
    </script>
</body>
</html>

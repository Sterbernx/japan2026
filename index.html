<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>üáØüáµ JAPONIA V13 FINAL</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;600&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        gold: '#d4af37',
                        neonGreen: '#39ff14',
                        neonPink: '#ff0055',
                        neonBlue: '#00f2ff',
                        blackBg: '#050505',
                        cardBg: '#121212'
                    },
                    fontFamily: {
                        'teko': ['Teko', 'sans-serif'],
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: #fff; -webkit-tap-highlight-color: transparent; }
        
        #map-container { position: fixed; top: 0; left: 0; width: 100%; height: 35vh; z-index: 0; border-bottom: 2px solid #222; }
        #map { width: 100%; height: 100%; background: #111; }
        
        #content-scroll { 
            position: fixed; top: 35vh; left: 0; width: 100%; height: 65vh; 
            overflow-y: auto; background: #050505; z-index: 10; 
            padding-bottom: 120px; 
        }

        .leaflet-tile-pane { filter: invert(100%) hue-rotate(180deg) brightness(85%) contrast(110%); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .pin-std { background: #000; color: #00f2ff; border: 2px solid #00f2ff; border-radius: 50%; text-align: center; font-weight: bold; font-size: 14px; line-height: 24px; box-shadow: 0 0 5px #00f2ff; }
        .pin-hotel { background: #ff0055; color: #fff; border: 1px solid #fff; border-radius: 4px; font-size: 18px; text-align: center; padding: 2px; z-index: 999; }
    </style>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body x-data="app()" x-init="init()" class="bg-blackBg text-white h-screen w-screen overflow-hidden">

    <div id="map-container">
        <div id="map"></div>
        <div class="absolute top-3 left-3 z-[500] bg-black/80 backdrop-blur px-3 py-1 rounded border border-gray-700 pointer-events-none">
            <div class="text-[10px] text-gray-400">PLAN:</div>
            <div class="text-sm font-bold text-neonBlue" x-text="currentDayTitle"></div>
        </div>
    </div>

    <div id="content-scroll">
        <div class="p-2 space-y-3">
            <template x-for="day in days" :key="day.id">
                <div class="bg-cardBg rounded-xl overflow-hidden border border-gray-900 transition-all"
                     :class="activeDay === day.id ? 'border-neonBlue ring-1 ring-neonBlue/20' : ''">
                    
                    <div @click="setDay(day)" class="p-4 flex justify-between items-center cursor-pointer bg-gradient-to-r from-cardBg to-black active:bg-gray-900">
                        <div>
                            <div class="font-teko text-2xl text-white leading-none tracking-wide" x-text="day.date"></div>
                            <div class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mt-1" x-text="day.title"></div>
                        </div>
                        <div class="text-neonBlue text-xl transform transition-transform" :class="activeDay === day.id ? 'rotate-90' : ''">‚û§</div>
                    </div>

                    <div x-show="activeDay === day.id" x-collapse class="bg-black/40 border-t border-gray-800">
                        <div class="p-2 bg-gray-900/50 border-b border-gray-800 text-[11px] text-gray-300 flex items-center gap-2">
                             <span>üöá <b>Transport:</b></span>
                             <span x-text="day.transport"></span>
                        </div>

                        <template x-for="(task, i) in day.tasks" :key="i">
                            <div class="p-3 border-b border-gray-800/50 last:border-0 relative">
                                <div class="flex gap-3 items-start">
                                    <div class="flex-none w-6 h-6 rounded-full border border-gray-600 flex items-center justify-center text-xs text-gray-400 mt-0.5" x-text="i+1"></div>
                                    <div class="flex-1">
                                        <div class="flex justify-between">
                                            <div class="text-sm font-bold text-gray-200" :class="task.done ? 'line-through opacity-50' : ''" x-text="task.name"></div>
                                            <input type="checkbox" class="accent-neonBlue w-5 h-5 rounded cursor-pointer opacity-50 checked:opacity-100" x-model="task.done" @change="save()">
                                        </div>
                                        
                                        <div class="mt-2 p-2 rounded border border-dashed transition-colors duration-300"
                                             :class="foodMode === 'cheap' ? 'bg-green-900/10 border-green-800/50' : 'bg-gold/10 border-gold/30'">
                                            <div class="flex justify-between items-center mb-1">
                                                <span class="text-[9px] font-bold uppercase" :class="foodMode === 'cheap' ? 'text-neonGreen' : 'text-gold'" x-text="foodMode === 'cheap' ? 'üå≠ BUDGET' : 'üíé LUXURY'"></span>
                                            </div>
                                            <div class="text-xs text-gray-400 italic"><span x-text="foodMode === 'cheap' ? task.cheapFood : task.richFood"></span></div>
                                        </div>

                                        <button x-show="task.coords" @click="nav(task.coords)" class="mt-2 flex items-center gap-1 text-[10px] text-gray-500 hover:text-white"><span>üìç NAWIGUJ</span></button>
                                    </div>
                                </div>
                            </div>
                        </template>
                         <div x-show="day.note" class="p-3 bg-blue-900/10 border-t border-gray-800 text-[10px] text-blue-300">‚ÑπÔ∏è <span x-text="day.note"></span></div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <div class="fixed bottom-0 left-0 w-full bg-black/95 backdrop-blur border-t border-gray-800 p-3 z-50">
        <div class="flex gap-3">
            <button @click="foodMode = 'cheap'" class="flex-1 py-3 rounded-lg border font-bold text-xs tracking-widest transition-all" :class="foodMode === 'cheap' ? 'bg-neonGreen text-black border-neonGreen shadow-[0_0_10px_#39ff14]' : 'bg-gray-900 text-gray-500 border-gray-700'">üå≠ TANIO</button>
            <button @click="foodMode = 'rich'" class="flex-1 py-3 rounded-lg border font-bold text-xs tracking-widest transition-all" :class="foodMode === 'rich' ? 'bg-gold text-black border-gold shadow-[0_0_10px_#d4af37]' : 'bg-gray-900 text-gray-500 border-gray-700'">üíé DROGO</button>
        </div>
    </div>

    <script>
        function app() {
            return {
                map: null,
                layerGroup: null,
                activeDay: 'd1',
                currentDayTitle: 'Przylot',
                foodMode: 'cheap', 
                
                hotels: {
                    tokyo1: [35.6930, 139.7924], // Galicia Ryogoku
                    kyoto: [35.0080, 135.7700],  // Le Lion
                    tokyo2: [35.6650, 139.8700]  // Tomi
                },

                // DANE Z PLIKU "Japonia_co_dzis_robimy.pdf"
                days: [
                    { 
                        id: 'd1', date: '22.03 (Niedz)', title: 'PRZYLOT', 
                        transport: 'Keisei Skyliner -> Taxi',
                        note: 'Transfer do Galicia Ryogoku. Konbini i spaƒá.',
                        tasks: [
                            { name: 'Przylot NRT (20:00)', coords: [35.7719, 140.3906], cheapFood: 'Kanapka z jajkiem (7-11)', richFood: '-', done: false },
                            { name: 'Check-in Galicia Ryogoku', coords: [35.6930, 139.7924], cheapFood: 'Onigiri', richFood: '-', done: false }
                        ]
                    },
                    { 
                        id: 'd2', date: '23.03 (Pon)', title: 'ASAKUSA & UENO', 
                        transport: 'Spacer / Ginza Line',
                        note: 'Zacznijcie od Senso-ji, potem spacer do parku Sumida i Ueno.',
                        tasks: [
                            { name: 'Sens≈ç-ji (Rano)', coords: [35.7147, 139.7966], cheapFood: 'Melonpan', richFood: 'Unagi (Wƒôgorz)', done: false },
                            { name: 'Asahi Head Office', coords: [35.7099, 139.8016], cheapFood: '-', richFood: 'Piwo w Sky Room', done: false },
                            { name: 'Sumida Park', coords: [35.7145, 139.8050], cheapFood: 'Kawa z automatu', richFood: '-', done: false },
                            { name: 'Park Ueno', coords: [35.7140, 139.7740], cheapFood: 'Street food', richFood: 'Innsyoutei', done: false },
                            { name: 'Yanaka Ginza', coords: [35.7275, 139.7645], cheapFood: 'Menchi Katsu', richFood: '-', done: false },
                            { name: 'Nezu Shrine', coords: [35.7202, 139.7607], cheapFood: '-', richFood: '-', done: false }
                        ]
                    },
                    { 
                        id: 'd3', date: '24.03 (Wt)', title: 'CENTRUM & AKIBA', 
                        transport: 'Oedo -> Hibiya -> Yamanote',
                        tasks: [
                            { name: 'Tsukiji Market', coords: [35.6654, 139.7706], cheapFood: 'Jajko na patyku', richFood: 'Sushi Dai (Omakase)', done: false },
                            { name: 'Pa≈Çac Cesarski & Ogrody', coords: [35.6851, 139.7527], cheapFood: '-', richFood: '-', done: false },
                            { name: 'Marunouchi / KITTE Garden', coords: [35.6795, 139.7640], cheapFood: 'Bento', richFood: 'Restauracja z widokiem na dworzec', done: false },
                            { name: 'Caretta Shiodome', coords: [35.6649, 139.7626], cheapFood: '-', richFood: '-', done: false },
                            { name: 'Akihabara', coords: [35.7022, 139.7741], cheapFood: 'Curry', richFood: 'Maid Cafe (drogie drinki)', done: false }
                        ]
                    },
                    { 
                        id: 'd4', date: '25.03 (≈ör)', title: 'SHIBUYA & SHINJUKU', 
                        transport: 'Odakyu / Inokashira',
                        note: 'Nocne ≈ºycie w Shinjuku na koniec.',
                        tasks: [
                            { name: 'Gotokuji Temple', coords: [35.6482, 139.6483], cheapFood: '-', richFood: '-', done: false },
                            { name: 'Shimokitazawa', coords: [35.6607, 139.6673], cheapFood: 'Curry Pan', richFood: 'Drip Coffee', done: false },
                            { name: 'Shibuya Crossing & Hachiko', coords: [35.6595, 139.7004], cheapFood: 'Genki Sushi', richFood: 'L\'Occitane Cafe', done: false },
                            { name: 'Shibuya Sky (Rezerwacja)', coords: [35.6585, 139.7018], cheapFood: '-', richFood: 'The Roof Bar', done: false },
                            { name: 'Center Gai', coords: [35.6604, 139.6990], cheapFood: 'Ramen', richFood: '-', done: false },
                            { name: 'Shinjuku (Golden Gai/Kabukicho)', coords: [35.6938, 139.7035], cheapFood: 'Omoide Yokocho', richFood: 'Bar Albatross', done: false }
                        ]
                    },
                    { 
                        id: 'd5', date: '26.03 (Czw)', title: 'HARAJUKU & DAIKANYAMA', 
                        transport: 'Yamanote -> Spacer',
                        note: 'Nowa trasa! Zamiast Ikebukuro macie super spacer.',
                        tasks: [
                            { name: 'Meiji Shrine', coords: [35.6764, 139.6993], cheapFood: '-', richFood: '-', done: false },
                            { name: 'Takeshita Street', coords: [35.6710, 139.7030], cheapFood: 'Nale≈õnik (Crepe)', richFood: '-', done: false },
                            { name: 'Cat Street', coords: [35.6675, 139.7060], cheapFood: 'Takoyaki', richFood: 'Luke\'s Lobster', done: false },
                            { name: 'Daikanyama (TSUTAYA)', coords: [35.6490, 139.6995], cheapFood: 'Kawa w konbini', richFood: 'IVY PLACE (Pancakes)', done: false },
                            { name: 'Nakameguro (Hanami)', coords: [35.6443, 139.6990], cheapFood: 'Piwo z puszki', richFood: 'Szampan nad rzekƒÖ', done: false }
                        ]
                    },
                    { 
                        id: 'd6', date: '27.03 (Pt)', title: 'KAMAKURA & ENOSHIMA', 
                        transport: 'JR Yokosuka',
                        note: 'Dosz≈Ça Hasedera i Hachimangu. Pe≈Çny dzie≈Ñ.',
                        tasks: [
                            { name: 'Wielki Budda (Kotoku-in)', coords: [35.3168, 139.5361], cheapFood: 'Lody', richFood: '-', done: false },
                            { name: 'Hasedera Temple', coords: [35.3125, 139.5328], cheapFood: 'Dango', richFood: 'Kaikoan (Restauracja)', done: false },
                            { name: 'Tsurugaoka Hachimangu', coords: [35.3260, 139.5564], cheapFood: 'Ulica Komachi-dori', richFood: '-', done: false },
                            { name: 'Enoshima Island', coords: [35.3016, 139.4814], cheapFood: 'Tako Senbei', richFood: 'Shirasu-don', done: false }
                        ]
                    },
                    { 
                        id: 'd7', date: '28.03 (Sob)', title: 'KIOTO START', 
                        transport: 'Shinkansen -> Taxi',
                        note: 'Przejazd do Kioto i od razu Gion.',
                        tasks: [
                            { name: 'Kiyomizu-dera', coords: [34.9948, 135.7850], cheapFood: 'Ciastko', richFood: 'Okutan Tofu', done: false },
                            { name: 'Sannenzaka & Ninenzaka', coords: [34.9972, 135.7824], cheapFood: '-', richFood: 'Starbucks Tatami', done: false },
                            { name: 'Yasaka Shrine', coords: [35.0036, 135.7785], cheapFood: 'Street food', richFood: '-', done: false },
                            { name: 'Gion & Shirakawa', coords: [35.0054, 135.7745], cheapFood: 'Ramen', richFood: 'Kaiseki', done: false }
                        ]
                    },
                    { 
                        id: 'd8', date: '29.03 (Niedz)', title: 'FUSHIMI & NISHIKI', 
                        transport: 'Keihan',
                        tasks: [
                            { name: 'Fushimi Inari (Rano!)', coords: [34.9671, 135.7726], cheapFood: 'Inari Sushi', richFood: 'Vermillion Cafe', done: false },
                            { name: 'Nishiki Market (Opcja)', coords: [35.0050, 135.7631], cheapFood: 'Wszystko na patyku', richFood: '-', done: false }
                        ]
                    },
                    { 
                        id: 'd9', date: '30.03 (Pon)', title: 'FILOZOFICZNE KIOTO', 
                        transport: 'Bus / Taxi',
                        tasks: [
                            { name: 'Ginkaku-ji', coords: [35.0268, 135.7982], cheapFood: 'Matcha', richFood: '-', done: false },
                            { name: 'Philosopher\'s Path', coords: [35.0230, 135.7950], cheapFood: '-', richFood: 'Cafe Terrazza', done: false },
                            { name: 'Nanzen-ji', coords: [35.0112, 135.7938], cheapFood: '-', richFood: 'Yudofu (Tofu)', done: false },
                            { name: 'Sanj≈´sangen-d≈ç', coords: [34.9878, 135.7717], cheapFood: '-', richFood: '-', done: false }
                        ]
                    },
                    { 
                        id: 'd10', date: '31.03 (Wt)', title: 'NARA', 
                        transport: 'Kintetsu',
                        tasks: [
                            { name: 'Nara Park & Jelonki', coords: [34.6850, 135.8430], cheapFood: 'Krakersy (dla jeleni)', richFood: 'Kakinoha Sushi', done: false },
                            { name: 'T≈çdai-ji', coords: [34.6889, 135.8398], cheapFood: '-', richFood: '-', done: false },
                            { name: 'Kasuga Taisha', coords: [34.6812, 135.8484], cheapFood: '-', richFood: '-', done: false }
                        ]
                    },
                     { 
                        id: 'd11', date: '01.04 (≈ör)', title: 'POWR√ìT DO TOKIO', 
                        transport: 'Shinkansen',
                        tasks: [
                            { name: 'Powr√≥t do Tokio', coords: [35.6812, 139.7671], cheapFood: 'Ekiben (Bento)', richFood: 'Green Car', done: false },
                            { name: 'Check-in TOMI Hotel', coords: [35.6650, 139.8700], cheapFood: '-', richFood: '-', done: false }
                        ]
                    },
                    { 
                        id: 'd12', date: '02.04 - 06.04', title: 'TOKIO KO≈ÉC√ìWKA', 
                        transport: 'Elastycznie',
                        tasks: [
                            { name: 'TeamLab / Odaiba', coords: [35.6154, 139.7956], cheapFood: 'Ramen w Aqua City', richFood: 'Hilton Odaiba', done: false },
                            { name: 'Shibuya / Akiba Zakupy', coords: null, cheapFood: 'Don Quijote', richFood: 'Parco Shibuya', done: false },
                            { name: 'Wylot (06.04)', coords: [35.7719, 140.3906], cheapFood: '-', richFood: '-', done: false }
                        ]
                    }
                ],

                init() {
                    this.map = L.map('map', {zoomControl: false}).setView([35.693, 139.792], 12);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                        attribution: '', maxZoom: 19
                    }).addTo(this.map);
                    this.layerGroup = L.layerGroup().addTo(this.map);
                    
                    const saved = localStorage.getItem('jp_v13_final');
                    if(saved) {
                        const parsed = JSON.parse(saved);
                        this.days.forEach((d, di) => {
                            if(parsed[di]) d.tasks.forEach((t, ti) => {
                                if(parsed[di].tasks[ti]) t.done = parsed[di].tasks[ti].done;
                            });
                        });
                    }
                    this.setDay(this.days[0]);
                },

                setDay(day) {
                    this.activeDay = day.id;
                    this.currentDayTitle = day.title;
                    this.renderMap(day);
                },

                renderMap(day) {
                    this.layerGroup.clearLayers();
                    const bounds = [];
                    
                    let hotelCoords = this.hotels.tokyo1;
                    if(['d7','d8','d9','d10'].includes(day.id)) hotelCoords = this.hotels.kyoto;
                    if(['d11','d12'].includes(day.id)) hotelCoords = this.hotels.tokyo2;

                    L.marker(hotelCoords, {icon: L.divIcon({html: 'üè®', className: 'pin-hotel'})}).addTo(this.layerGroup);
                    bounds.push(hotelCoords);

                    day.tasks.forEach((t, i) => {
                        if(t.coords) {
                            L.marker(t.coords, {
                                icon: L.divIcon({html: i+1, className: 'pin-std', iconSize:[24,24]})
                            }).addTo(this.layerGroup);
                            bounds.push(t.coords);
                        }
                    });

                    if(bounds.length > 0) {
                        this.map.flyToBounds(bounds, {padding: [50, 50], duration: 1});
                    }
                },

                nav(coords) {
                    window.open(`https://www.google.com/maps/dir/?api=1&destination=${coords[0]},${coords[1]}&travelmode=transit`, '_blank');
                },

                save() {
                    localStorage.setItem('jp_v13_final', JSON.stringify(this.days));
                }
            }
        }
    </script>
</body>
</html>

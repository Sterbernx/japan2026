<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>JAPONIA 2K26 // NEON</title>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Outfit', 'sans-serif'], mono: ['Space Grotesk', 'monospace'] },
                    colors: {
                        cyber: '#00f0ff',
                        vip: '#ffd700',
                        void: '#050505',
                        glass: 'rgba(20, 20, 20, 0.6)'
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>
    
    <style>
        body { background: #000; color: #fff; overflow: hidden; }
        .leaflet-tile-pane { filter: invert(100%) hue-rotate(180deg) brightness(80%) contrast(115%) grayscale(20%); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass-panel { background: rgba(20, 20, 20, 0.6); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-top: 1px solid rgba(255,255,255,0.1); }
        
        /* Map Pins */
        .pin-vip { background: #ffd700; color: #000; border: 2px solid #fff; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-weight: bold; box-shadow: 0 0 15px #ffd700; }
        .pin-std { background: #000; color: #00f0ff; border: 1px solid #00f0ff; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
        .pin-hotel { font-size: 24px; filter: drop-shadow(0 0 10px #ff0055); }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { motion, AnimatePresence } = window.Motion;

        // --- DATA (Zgodnie z plikiem PDF Japonia_co_dzis_robimy.pdf) ---
        const HOTELS = {
            tokyo1: { name: 'Galicia Ryogoku', coords: [35.6930, 139.7924] },
            kyoto: { name: 'Le Lion d\'or', coords: [35.0080, 135.7700] },
            tokyo2: { name: 'TOMI Hotel', coords: [35.6650, 139.8700] }
        };

        const TRIP_DATA = [
            { id: 'd1', date: '22.03', title: 'PRZYLOT', hotel: 'tokyo1', trans: 'Skyliner', tasks: [
                { t: 'Przylot NRT (20:00)', c: [35.7719, 140.3906], food: { cheap: 'Kanapka z jajkiem', rich: 'Room Service' } },
                { t: 'Transfer do Galicia Ryogoku', c: [35.6930, 139.7924] }
            ]},
            { id: 'd2', date: '23.03', title: 'ASAKUSA & UENO', hotel: 'tokyo1', trans: 'Ginza Line', tasks: [
                { t: 'Sens≈ç-ji Temple', c: [35.7147, 139.7966], food: { cheap: 'Melonpan', rich: 'Unagi (Wƒôgorz)' } },
                { t: 'Asahi Head Office', c: [35.7099, 139.8016] },
                { t: 'Park Ueno', c: [35.7140, 139.7740], food: { cheap: 'Ameyoko Street Food', rich: 'Innsyoutei Kaiseki' } },
                { t: 'Yanaka Ginza', c: [35.7275, 139.7645], food: { cheap: 'Menchi Katsu', rich: 'Tea Ceremony' } },
                { t: 'Nezu Shrine', c: [35.7202, 139.7607] }
            ]},
            { id: 'd3', date: '24.03', title: 'CENTRUM & AKIBA', hotel: 'tokyo1', trans: 'Oedo / Yamanote', tasks: [
                { t: 'Tsukiji Market', c: [35.6654, 139.7706], food: { cheap: 'Tamago Stick', rich: 'Sushi Dai Omakase' } },
                { t: 'Ogrody Pa≈Çacu', c: [35.6851, 139.7527] },
                { t: 'Marunouchi / KITTE', c: [35.6795, 139.7640] },
                { t: 'Caretta Shiodome (Widok)', c: [35.6649, 139.7626] },
                { t: 'Akihabara', c: [35.7022, 139.7741], food: { cheap: 'CoCo Curry', rich: 'Yakiniku UDX' } }
            ]},
            { id: 'd4', date: '25.03', title: 'SHIBUYA & SHINJUKU', hotel: 'tokyo1', trans: 'Odakyu / Inokashira', tasks: [
                { t: 'Gotokuji (Koty)', c: [35.6482, 139.6483] },
                { t: 'Shimokitazawa', c: [35.6607, 139.6673], food: { cheap: 'Curry Pan', rich: 'Hipster Coffee' } },
                { t: 'Shibuya Crossing', c: [35.6595, 139.7004], food: { cheap: 'Genki Sushi', rich: 'L\'Occitane Cafe' } },
                { t: 'Shibuya Sky (Rezerwacja)', c: [35.6585, 139.7018], food: { cheap: '-', rich: 'The Roof Bar' } },
                { t: 'Kabukicho & Golden Gai', c: [35.6938, 139.7035], food: { cheap: 'Omoide Yokocho', rich: 'Bar Albatross' } }
            ]},
            { id: 'd5', date: '26.03', title: 'FASHION DISTRICT', hotel: 'tokyo1', trans: 'Yamanote / Spacer', tasks: [
                { t: 'Meiji Shrine', c: [35.6764, 139.6993] },
                { t: 'Takeshita Street', c: [35.6710, 139.7030], food: { cheap: 'Crepes', rich: '-' } },
                { t: 'Cat Street', c: [35.6675, 139.7060], food: { cheap: 'Takoyaki', rich: 'Luke\'s Lobster' } },
                { t: 'Daikanyama (TSUTAYA)', c: [35.6490, 139.6995], food: { cheap: 'Konbini Coffee', rich: 'IVY PLACE' } },
                { t: 'Nakameguro (Hanami)', c: [35.6443, 139.6990], food: { cheap: 'Piwo nad rzekƒÖ', rich: 'Szampan & Truskawki' } }
            ]},
            { id: 'd6', date: '27.03', title: 'KAMAKURA TRIP', hotel: 'tokyo1', trans: 'JR Yokosuka', tasks: [
                { t: 'Wielki Budda', c: [35.3168, 139.5361], food: { cheap: 'Lody Batatowe', rich: 'Kaikoan' } },
                { t: 'Hasedera Temple', c: [35.3125, 139.5328] },
                { t: 'Enoshima Island', c: [35.3016, 139.4814], food: { cheap: 'Tako Senbei', rich: 'Shirasu-don' } }
            ]},
            { id: 'd7', date: '28.03', title: 'KIOTO GION', hotel: 'kyoto', trans: 'Shinkansen', tasks: [
                { t: 'Transfer Tokio -> Kioto', c: [34.9858, 135.7588], food: { cheap: 'Ekiben', rich: 'Green Car Bento' } },
                { t: 'Kiyomizu-dera', c: [34.9948, 135.7850] },
                { t: 'Sannenzaka', c: [34.9972, 135.7824], food: { cheap: 'Yatsuhashi', rich: 'Starbucks Tatami' } },
                { t: 'Gion & Shirakawa', c: [35.0054, 135.7745], food: { cheap: 'Ramen', rich: 'Kaiseki z GejszƒÖ' } }
            ]},
            { id: 'd8', date: '29.03', title: 'FUSHIMI INARI', hotel: 'kyoto', trans: 'Keihan Line', tasks: [
                { t: 'Fushimi Inari', c: [34.9671, 135.7726], food: { cheap: 'Kitsune Udon', rich: 'Vermillion Cafe' } },
                { t: 'Nishiki Market', c: [35.0050, 135.7631], food: { cheap: 'Street Food', rich: '-' } }
            ]},
            { id: 'd9', date: '30.03', title: 'ZEN KYOTO', hotel: 'kyoto', trans: 'Bus / Taxi', tasks: [
                { t: 'Ginkaku-ji', c: [35.0268, 135.7982], food: { cheap: 'Matcha', rich: '-' } },
                { t: 'Philosopher\'s Path', c: [35.0230, 135.7950], food: { cheap: '-', rich: 'Cafe Terrazza' } },
                { t: 'Nanzen-ji', c: [35.0112, 135.7938], food: { cheap: '-', rich: 'Yudofu (Tofu)' } }
            ]},
            { id: 'd10', date: '31.03', title: 'NARA', hotel: 'kyoto', trans: 'Kintetsu', tasks: [
                { t: 'Nara Park (Jelonki)', c: [34.6850, 135.8430], food: { cheap: 'Krakersy', rich: 'Kakinoha Sushi' } },
                { t: 'T≈çdai-ji', c: [34.6889, 135.8398] }
            ]},
            { id: 'd11', date: '01.04', title: 'POWR√ìT DO TOKIO', hotel: 'tokyo2', trans: 'Shinkansen', tasks: [
                { t: 'Check-in TOMI Hotel', c: [35.6650, 139.8700] },
                { t: 'Wieczorny Chill', c: null }
            ]},
            { id: 'd12', date: '02-06.04', title: 'FREE TIME', hotel: 'tokyo2', trans: 'Metro', tasks: [
                { t: 'Odaiba / TeamLab', c: [35.6154, 139.7956] },
                { t: 'Zakupy (Donki)', c: null },
                { t: 'Wylot (06.04)', c: [35.7719, 140.3906] }
            ]}
        ];

        // --- COMPONENTS ---

        const MapComponent = ({ activeDay, days, hotels }) => {
            const mapRef = useRef(null);
            const layerRef = useRef(null);

            useEffect(() => {
                if (!mapRef.current) {
                    mapRef.current = L.map('map-container', { zoomControl: false, attributionControl: false }).setView([35.693, 139.792], 12);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { maxZoom: 19 }).addTo(mapRef.current);
                    layerRef.current = L.layerGroup().addTo(mapRef.current);
                }
            }, []);

            useEffect(() => {
                if (!mapRef.current || !layerRef.current) return;
                
                const day = days.find(d => d.id === activeDay);
                if (!day) return;

                layerRef.current.clearLayers();
                const bounds = [];
                const hotel = hotels[day.hotel];

                // Hotel Marker
                const hotelIcon = L.divIcon({ html: 'üè®', className: 'pin-hotel', iconSize: [30, 30] });
                L.marker(hotel.coords, { icon: hotelIcon }).addTo(layerRef.current);
                bounds.push(hotel.coords);

                // Tasks Markers
                day.tasks.forEach((t, i) => {
                    if (t.c) {
                        const icon = L.divIcon({ html: `<div>${i + 1}</div>`, className: 'pin-std' });
                        L.marker(t.c, { icon }).addTo(layerRef.current);
                        bounds.push(t.c);
                    }
                });

                if (bounds.length > 0) {
                    mapRef.current.flyToBounds(bounds, { padding: [50, 50], duration: 1.2 });
                }
            }, [activeDay]);

            return <div id="map-container" className="fixed top-0 left-0 w-full h-[35vh] z-0 border-b-2 border-void" />;
        };

        const TaskItem = ({ task, index, checked, onToggle, mode }) => {
            return (
                <div className="relative p-4 border-b border-gray-800/50 last:border-0">
                    <div className="flex gap-4 items-start">
                        <div className={`flex-none w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs border border-gray-700 mt-0.5 transition-colors ${checked ? 'bg-cyber text-black border-cyber' : 'text-gray-500'}`}>
                            {index + 1}
                        </div>
                        <div className="flex-1">
                            <div className="flex justify-between items-start">
                                <span className={`text-sm font-bold transition-all ${checked ? 'text-gray-600 line-through' : 'text-gray-100'}`}>
                                    {task.t}
                                </span>
                                <input type="checkbox" checked={checked} onChange={onToggle} className="w-5 h-5 accent-cyber opacity-50 checked:opacity-100 cursor-pointer" />
                            </div>

                            <AnimatePresence mode="wait">
                                {task.food && (
                                    <motion.div 
                                        key={mode}
                                        initial={{ opacity: 0, y: 5 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        exit={{ opacity: 0, y: -5 }}
                                        className={`mt-2 p-2 rounded border border-dashed text-xs ${mode === 'cheap' ? 'border-green-800 bg-green-900/10 text-green-400' : 'border-vip bg-vip/10 text-vip'}`}
                                    >
                                        <div className="font-bold text-[10px] uppercase mb-0.5">
                                            {mode === 'cheap' ? 'üå≠ Budget' : 'üíé VIP / Rich'}
                                        </div>
                                        {mode === 'cheap' ? task.food.cheap : task.food.rich}
                                    </motion.div>
                                )}
                            </AnimatePresence>
                            
                            {task.c && (
                                <button onClick={() => window.open(`https://maps.google.com/?q=${task.c[0]},${task.c[1]}`, '_blank')} className="mt-3 text-[10px] flex items-center gap-1 text-gray-500 hover:text-cyber transition-colors">
                                    <span>üìç</span> NAWIGUJ
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeDay, setActiveDay] = useState('d1');
            const [mode, setMode] = useState('cheap');
            const [checked, setChecked] = useState(() => JSON.parse(localStorage.getItem('jp_v13')) || {});

            const toggleCheck = (dayId, taskIdx) => {
                const key = `${dayId}-${taskIdx}`;
                const newChecked = { ...checked, [key]: !checked[key] };
                setChecked(newChecked);
                localStorage.setItem('jp_v13', JSON.stringify(newChecked));
                if (navigator.vibrate) navigator.vibrate(10);
            };

            const currentDay = TRIP_DATA.find(d => d.id === activeDay);

            return (
                <div className="h-screen w-screen bg-void text-white font-sans selection:bg-cyber selection:text-black">
                    <MapComponent activeDay={activeDay} days={TRIP_DATA} hotels={HOTELS} />

                    {/* OVERLAY MAP INFO */}
                    <div className="fixed top-4 left-4 z-10 glass-panel px-3 py-1 rounded-full border-l-4 border-cyber">
                        <div className="text-[9px] text-gray-400 font-mono tracking-widest uppercase">Cel:</div>
                        <div className="text-sm font-bold text-cyber drop-shadow-lg">{currentDay.title}</div>
                    </div>

                    {/* SCROLLABLE CONTENT */}
                    <div className="fixed top-[35vh] left-0 w-full h-[65vh] overflow-y-auto pb-32 bg-void z-20 shadow-[0_-10px_40px_rgba(0,0,0,1)]">
                        <div className="p-2 space-y-4 pt-4">
                            {TRIP_DATA.map((day) => (
                                <motion.div 
                                    key={day.id}
                                    initial={false}
                                    animate={{ 
                                        borderColor: activeDay === day.id ? (mode==='cheap'?'#39ff14':'#ffd700') : '#1f2937',
                                        scale: activeDay === day.id ? 1 : 0.98 
                                    }}
                                    className={`bg-gray-900/40 rounded-xl overflow-hidden border border-gray-800 transition-all duration-500`}
                                >
                                    <div 
                                        onClick={() => setActiveDay(day.id)}
                                        className={`p-4 flex justify-between items-center cursor-pointer bg-gradient-to-r ${activeDay === day.id ? 'from-gray-900 to-black' : 'from-transparent to-transparent'}`}
                                    >
                                        <div>
                                            <div className="font-mono text-2xl font-bold tracking-tighter">{day.date}</div>
                                            <div className="text-[10px] text-gray-400 font-bold uppercase tracking-[0.2em]">{day.title}</div>
                                        </div>
                                        <div className={`text-xl transition-transform duration-300 ${activeDay === day.id ? 'rotate-90 text-cyber' : 'text-gray-600'}`}>‚û§</div>
                                    </div>

                                    <AnimatePresence>
                                        {activeDay === day.id && (
                                            <motion.div 
                                                initial={{ height: 0, opacity: 0 }}
                                                animate={{ height: 'auto', opacity: 1 }}
                                                exit={{ height: 0, opacity: 0 }}
                                                className="bg-black/20 border-t border-gray-800"
                                            >
                                                <div className="px-4 py-2 bg-gray-900/80 text-[10px] text-gray-400 font-mono flex items-center gap-2 border-b border-gray-800">
                                                    <span>üöá TRANSPORT:</span> <span className="text-white">{day.trans}</span>
                                                </div>
                                                
                                                {day.tasks.map((task, i) => (
                                                    <TaskItem 
                                                        key={i} 
                                                        task={task} 
                                                        index={i} 
                                                        mode={mode}
                                                        checked={!!checked[`${day.id}-${i}`]} 
                                                        onToggle={() => toggleCheck(day.id, i)} 
                                                    />
                                                ))}
                                            </motion.div>
                                        )}
                                    </AnimatePresence>
                                </motion.div>
                            ))}
                        </div>
                    </div>

                    {/* FOOTER CONTROLS */}
                    <div className="fixed bottom-0 left-0 w-full glass-panel p-4 z-50 pb-8">
                        <div className="flex gap-4">
                            <button 
                                onClick={() => setMode('cheap')}
                                className={`flex-1 py-3 rounded-lg font-bold text-xs tracking-widest transition-all duration-300 ${mode === 'cheap' ? 'bg-green-500 text-black shadow-[0_0_20px_rgba(34,197,94,0.4)]' : 'bg-gray-900 text-gray-600 border border-gray-800'}`}
                            >
                                üå≠ TANIO
                            </button>
                            <button 
                                onClick={() => setMode('rich')}
                                className={`flex-1 py-3 rounded-lg font-bold text-xs tracking-widest transition-all duration-300 ${mode === 'rich' ? 'bg-vip text-black shadow-[0_0_20px_rgba(255,215,0,0.4)]' : 'bg-gray-900 text-gray-600 border border-gray-800'}`}
                            >
                                üíé NA BOGATO
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

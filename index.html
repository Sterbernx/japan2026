<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>JAPONIA V15 NAVIGATOR</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], hud: ['Rajdhani', 'sans-serif'] },
                    colors: {
                        cyber: '#00f3ff',
                        vip: '#ffd700',
                        void: '#050505',
                        panel: '#111'
                    }
                }
            }
        }
    </script>
    
    <style>
        body { background: #000; color: #fff; overflow: hidden; }
        
        /* MAPA FIX */
        #map-container { position: fixed; top: 0; left: 0; width: 100%; height: 45vh; z-index: 0; border-bottom: 2px solid #00f3ff; }
        #map { width: 100%; height: 100%; background: #0b0b0b; }
        .leaflet-tile-pane { filter: invert(100%) hue-rotate(180deg) brightness(85%) contrast(120%) grayscale(20%); }
        .leaflet-popup-content-wrapper { background: rgba(0,0,0,0.9); border: 1px solid #00f3ff; color: #fff; border-radius: 0; }
        .leaflet-popup-tip { background: #00f3ff; }

        /* LISTA SCROLL */
        #content-scroll { 
            position: fixed; top: 45vh; left: 0; width: 100%; height: 55vh; 
            overflow-y: auto; background: #050505; z-index: 10; 
            padding-bottom: 80px;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* PINS */
        .pin-std { 
            background: #000; color: #00f3ff; border: 2px solid #00f3ff; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            font-weight: bold; font-size: 14px; box-shadow: 0 0 10px #00f3ff;
        }
        .pin-hotel { font-size: 24px; filter: drop-shadow(0 0 5px #ff0055); text-align: center; }
    </style>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body x-data="app()" x-init="init()" class="h-screen w-screen bg-void text-white">

    <div id="map-container">
        <div id="map"></div>
        <div class="absolute top-3 left-3 z-[500] bg-black/80 backdrop-blur px-3 py-2 border-l-4 border-cyber">
            <div class="text-[10px] text-gray-400 font-hud tracking-widest uppercase">AKTUALNY CEL</div>
            <div class="text-sm font-bold text-cyber font-hud text-lg leading-none" x-text="currentDayTitle"></div>
        </div>
        <button @click="locateMe()" class="absolute bottom-3 right-3 z-[500] bg-black/80 p-3 rounded-full border border-cyber text-cyber shadow-[0_0_15px_#00f3ff]">
            üìç
        </button>
    </div>

    <div id="content-scroll">
        <div class="p-2 space-y-4">
            
            <template x-for="day in days" :key="day.id">
                <div class="bg-panel border border-gray-800 transition-all duration-300"
                     :class="activeDay === day.id ? 'border-cyber shadow-[0_0_10px_rgba(0,243,255,0.2)]' : 'opacity-70'">
                    
                    <div @click="setDay(day)" class="p-4 flex justify-between items-center cursor-pointer bg-gradient-to-r from-panel to-black">
                        <div>
                            <div class="font-hud text-2xl font-bold" x-text="day.date"></div>
                            <div class="text-[10px] text-gray-500 font-bold uppercase tracking-[0.2em]" x-text="day.title"></div>
                        </div>
                        <div class="text-cyber text-xl transition-transform" :class="activeDay === day.id ? 'rotate-90' : ''">‚û§</div>
                    </div>

                    <div x-show="activeDay === day.id" class="border-t border-gray-800 bg-black/30">
                        
                        <div class="p-3 bg-cyber/5 text-[11px] text-cyber border-b border-gray-800 font-mono">
                            üè® START: <span x-text="hotels[day.hotelKey].name"></span>
                        </div>

                        <template x-for="(task, i) in day.tasks" :key="i">
                            <div class="border-b border-gray-800 last:border-0 transition-colors hover:bg-white/5">
                                
                                <div @click="toggleTask(day.id, i)" class="p-4 cursor-pointer">
                                    <div class="flex gap-4 items-center">
                                        <div class="flex-none w-8 h-8 rounded-full border-2 border-gray-700 flex items-center justify-center font-bold text-sm text-gray-500 transition-all"
                                             :class="task.expanded ? 'bg-cyber text-black border-cyber' : ''">
                                            <span x-text="i+1"></span>
                                        </div>
                                        <div class="flex-1">
                                            <div class="font-bold text-sm text-gray-200" x-text="task.name"></div>
                                            <div class="text-[10px] text-gray-500 mt-1 flex gap-2">
                                                <span x-show="!task.expanded">‚ñº Kliknij po szczeg√≥≈Çy</span>
                                                <span x-show="task.expanded" class="text-cyber">‚ñ≤ Zwi≈Ñ</span>
                                            </div>
                                        </div>
                                        <input type="checkbox" @click.stop class="accent-cyber w-6 h-6 rounded cursor-pointer opacity-50 checked:opacity-100">
                                    </div>
                                </div>

                                <div x-show="task.expanded" class="bg-gray-900/80 px-4 pb-4 border-l-4 border-cyber ml-4 mb-2">
                                    
                                    <div class="mb-3 pt-2">
                                        <div class="text-[10px] text-gray-400 font-bold uppercase tracking-widest mb-1">CO TO JEST?</div>
                                        <div class="text-sm text-gray-200 leading-snug" x-text="task.desc"></div>
                                    </div>

                                    <div class="mb-3">
                                        <div class="text-[10px] text-gray-400 font-bold uppercase tracking-widest mb-1">JAK DOJCHAƒÜ?</div>
                                        <div class="text-sm text-neonGreen font-mono bg-black/50 p-2 rounded border border-gray-700">
                                            üöá <span x-text="task.transport"></span>
                                        </div>
                                    </div>

                                    <div class="flex gap-2">
                                        <button x-show="task.coords" @click.stop="nav(task.coords)" class="flex-1 bg-cyber text-black font-bold text-xs py-2 rounded hover:bg-white transition">
                                            üìç NAWIGUJ
                                        </button>
                                        <button x-show="task.food" @click.stop="alert('Polecajka: ' + task.food)" class="px-4 border border-gold text-gold font-bold text-xs py-2 rounded hover:bg-gold hover:text-black transition">
                                            üçî GASTRO
                                        </button>
                                    </div>

                                </div>

                            </div>
                        </template>
                    </div>
                </div>
            </template>
            <div class="h-20"></div>
        </div>
    </div>

    <script>
        function app() {
            return {
                map: null,
                layerGroup: null,
                routeLine: null,
                activeDay: 'd1',
                currentDayTitle: 'Przylot',
                
                hotels: {
                    tokyo1: { name: 'Galicia Ryogoku', coords: [35.6930, 139.7924] },
                    kyoto: { name: 'Le Lion d\'or', coords: [35.0080, 135.7700] },
                    tokyo2: { name: 'TOMI Hotel', coords: [35.6650, 139.8700] }
                },

                days: [
                    { 
                        id: 'd1', date: '22.03', title: 'PRZYLOT', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'LƒÖdowanie NRT (20:00)', 
                                coords: [35.7719, 140.3906], 
                                desc: 'Lotnisko Narita. Tu zaczynacie przygodƒô.',
                                transport: 'PociƒÖg Keisei Skyliner do Nippori/Ueno, potem Taxi do Ryogoku.',
                                expanded: false 
                            },
                            { 
                                name: 'Check-in: Galicia Ryogoku', 
                                coords: [35.6930, 139.7924], 
                                desc: 'Wasza baza wypadowa. Blisko areny Sumo.',
                                transport: 'Spacer z taks√≥wki.',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd2', date: '23.03', title: 'ASAKUSA & UENO', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'Sens≈ç-ji Temple', 
                                coords: [35.7147, 139.7966], 
                                desc: 'Najstarsza i najs≈Çynniejsza ≈õwiƒÖtynia w Tokio. Wielki czerwony lampion.',
                                transport: 'Metro Oedo Line (Ryogoku -> Kuramae) + spacer 10 min.',
                                food: 'Melonpan na Nakamise-dori',
                                expanded: false 
                            },
                            { 
                                name: 'Park Ueno', 
                                coords: [35.7140, 139.7740], 
                                desc: 'Wielki park, muzea i zoo. Dobre miejsce na spacer.',
                                transport: 'Metro Ginza Line (Asakusa -> Ueno) - 5 min.',
                                expanded: false 
                            },
                            { 
                                name: 'Yanaka Ginza', 
                                coords: [35.7275, 139.7645], 
                                desc: 'Stare Tokio. Klimat lat 50., koty i ma≈Çe sklepiki.',
                                transport: 'Spacer przez park Ueno (20 min) lub JR Yamanote (Ueno -> Nippori).',
                                food: 'Menchi Katsu (Krokiet miƒôsny)',
                                expanded: false 
                            },
                            { 
                                name: 'Daikoku-yu Onsen', 
                                coords: [35.7077, 139.8056], 
                                desc: 'Tradycyjna ≈Ça≈∫nia publiczna. Pamiƒôtajcie o myciu przed wej≈õciem!',
                                transport: 'Taxi z Ueno/Yanaka (najszybciej) lub powr√≥t do Ryogoku.',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd3', date: '24.03', title: 'CENTRUM & AKIBA', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'Tsukiji Market', 
                                coords: [35.6654, 139.7706], 
                                desc: 'Stary targ rybny. Kr√≥lestwo street foodu.',
                                transport: 'Metro Oedo Line (Ryogoku -> Tsukijishijo) - bezpo≈õrednio.',
                                food: 'Jajko Tamago na patyku',
                                expanded: false 
                            },
                            { 
                                name: 'Pa≈Çac Cesarski', 
                                coords: [35.6851, 139.7527], 
                                desc: 'Siedziba Cesarza. Wchodzi siƒô tylko do ogrod√≥w wschodnich.',
                                transport: 'Metro Hibiya Line (Tsukiji -> Hibiya) + spacer.',
                                expanded: false 
                            },
                            { 
                                name: 'Akihabara', 
                                coords: [35.7022, 139.7741], 
                                desc: 'Dzielnica elektroniki, anime i gier. Neonowy oczoplƒÖs.',
                                transport: 'JR Yamanote Line (Tokyo Sta. -> Akihabara).',
                                food: 'CoCo Curry House',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd4', date: '25.03', title: 'SHIBUYA & SHINJUKU', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'Gotokuji (Koty)', 
                                coords: [35.6482, 139.6483], 
                                desc: '≈öwiƒÖtynia z tysiƒÖcami figurek kot√≥w maneki-neko.',
                                transport: 'Skomplikowane: JR do Shinjuku -> Odakyu Line do Gotokuji.',
                                expanded: false 
                            },
                            { 
                                name: 'Shimokitazawa', 
                                coords: [35.6607, 139.6673], 
                                desc: 'Dzielnica hipster√≥w, lumpeks√≥w i kawy.',
                                transport: 'Odakyu Line (z Gotokuji w stronƒô Shinjuku).',
                                expanded: false 
                            },
                            { 
                                name: 'Shibuya Crossing', 
                                coords: [35.6595, 139.7004], 
                                desc: 'Najs≈Çynniejsze skrzy≈ºowanie ≈õwiata. T≈Çumy ludzi.',
                                transport: 'Keio Inokashira Line (Shimokitazawa -> Shibuya) - 4 min.',
                                expanded: false 
                            },
                            { 
                                name: 'Shinjuku (Kabukicho)', 
                                coords: [35.6938, 139.7035], 
                                desc: 'Dzielnica czerwonych latarni, Godzilli i bar√≥w.',
                                transport: 'JR Yamanote (Shibuya -> Shinjuku).',
                                food: 'Omoide Yokocho (Yakitori)',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd5', date: '26.03', title: 'FASHION WALK', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'Meiji Shrine', 
                                coords: [35.6764, 139.6993], 
                                desc: 'Wielka ≈õwiƒÖtynia w lesie w ≈õrodku miasta.',
                                transport: 'JR Yamanote do Harajuku.',
                                expanded: false 
                            },
                            { 
                                name: 'Takeshita Street', 
                                coords: [35.6710, 139.7030], 
                                desc: 'Szale≈Ñstwo mody nastolatek. Kolorowo i t≈Çoczno.',
                                transport: 'Spacer z Meiji Shrine (obok).',
                                food: 'Nale≈õnik z wystawki',
                                expanded: false 
                            },
                            { 
                                name: 'Daikanyama', 
                                coords: [35.6490, 139.6995], 
                                desc: 'Luksusowa dzielnica, super architektura (TSUTAYA Books).',
                                transport: 'Spacer (20 min) lub Tokyu Toyoko Line.',
                                expanded: false 
                            },
                            { 
                                name: 'Nakameguro', 
                                coords: [35.6443, 139.6990], 
                                desc: 'Kana≈Ç z wi≈õniami. Idealne na wieczorny drink.',
                                transport: 'Spacer z Daikanyama (zej≈õcie w d√≥≈Ç do rzeki).',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd6', date: '27.03', title: 'KAMAKURA', hotelKey: 'tokyo1',
                        tasks: [
                            { 
                                name: 'Wielki Budda', 
                                coords: [35.3168, 139.5361], 
                                desc: 'Ogromny posƒÖg Buddy na powietrzu. Ikona.',
                                transport: 'PociƒÖg JR Yokosuka Line (Tokyo -> Kamakura) + kolejka Enoden.',
                                expanded: false 
                            },
                            { 
                                name: 'Enoshima', 
                                coords: [35.3016, 139.4814], 
                                desc: 'Wyspa po≈ÇƒÖczona mostem. Pla≈ºe, ≈õwiƒÖtynie, widoki.',
                                transport: 'Kolejka Enoden (Klimatyczna trasa wzd≈Çu≈º morza).',
                                food: 'Shirasu-don (ry≈º z rybkami)',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd7', date: '28.03', title: 'KIOTO START', hotelKey: 'kyoto',
                        tasks: [
                            { 
                                name: 'Transfer do Kioto', 
                                coords: [34.9858, 135.7588], 
                                desc: 'Shinkansen Hikari/Nozomi. 2h 20min jazdy.',
                                transport: 'Z Tokyo Station.',
                                expanded: false 
                            },
                            { 
                                name: 'Kiyomizu-dera', 
                                coords: [34.9948, 135.7850], 
                                desc: '≈öwiƒÖtynia Czystej Wody na drewnianym tarasie.',
                                transport: 'Taxi z hotelu (najlepiej) lub Bus 206.',
                                expanded: false 
                            },
                            { 
                                name: 'Gion District', 
                                coords: [35.0054, 135.7745], 
                                desc: 'Dzielnica Gejsz. Stare domy machiya.',
                                transport: 'Spacer w d√≥≈Ç z Kiyomizu przez Sannenzaka.',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd8', date: '29.03', title: 'FUSHIMI INARI', hotelKey: 'kyoto',
                        tasks: [
                            { 
                                name: 'Fushimi Inari', 
                                coords: [34.9671, 135.7726], 
                                desc: 'TysiƒÖce czerwonych bram Torii. Idzie siƒô w g√≥rƒô.',
                                transport: 'PociƒÖg Keihan Line lub JR Nara Line (5 min jazdy).',
                                expanded: false 
                            },
                            { 
                                name: 'Nishiki Market', 
                                coords: [35.0050, 135.7631], 
                                desc: '"Kuchnia Kioto". WƒÖska ulica z jedzeniem.',
                                transport: 'Powr√≥t do centrum, metro do Shijo.',
                                food: 'Wszystko na patyku',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd10', date: '31.03', title: 'NARA', hotelKey: 'kyoto',
                        tasks: [
                            { 
                                name: 'Nara Park', 
                                coords: [34.6850, 135.8430], 
                                desc: 'Park pe≈Çen wolno ≈ºyjƒÖcych jeleni. Mo≈ºna karmiƒá.',
                                transport: 'PociƒÖg Kintetsu Nara Line (40 min).',
                                expanded: false 
                            },
                            { 
                                name: 'Todai-ji', 
                                coords: [34.6889, 135.8398], 
                                desc: 'Najwiƒôkszy drewniany budynek ≈õwiata z wielkim BuddƒÖ.',
                                transport: 'Spacer przez park.',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd11', date: '01.04', title: 'POWR√ìT', hotelKey: 'tokyo2',
                        tasks: [
                            { 
                                name: 'Powr√≥t do Tokio', 
                                coords: [35.6812, 139.7671], 
                                desc: 'Shinkansen z powrotem.',
                                transport: 'Z Kyoto Station.',
                                expanded: false 
                            },
                            { 
                                name: 'Check-in TOMI Hotel', 
                                coords: [35.6650, 139.8700], 
                                desc: 'Ostatnia baza noclegowa.',
                                transport: 'Zale≈ºy gdzie jest hotel (Taxi).',
                                expanded: false 
                            }
                        ]
                    },
                    { 
                        id: 'd12', date: '06.04', title: 'WYLOT', hotelKey: 'tokyo2',
                        tasks: [
                            { 
                                name: 'Narita Airport', 
                                coords: [35.7719, 140.3906], 
                                desc: 'Koniec wycieczki.',
                                transport: 'Keisei Skyliner.',
                                expanded: false 
                            }
                        ]
                    }
                ],

                init() {
                    this.map = L.map('map', {zoomControl: false}).setView([35.693, 139.792], 12);
                    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { maxZoom: 19 }).addTo(this.map);
                    this.layerGroup = L.layerGroup().addTo(this.map);
                    this.setDay(this.days[0]);
                },

                setDay(day) {
                    this.activeDay = day.id;
                    this.currentDayTitle = day.title;
                    
                    this.layerGroup.clearLayers();
                    const bounds = [];
                    const points = [];

                    // Hotel
                    const hotel = this.hotels[day.hotelKey];
                    L.marker(hotel.coords, {
                        icon: L.divIcon({html: 'üè®', className: 'pin-hotel'})
                    }).addTo(this.layerGroup);
                    bounds.push(hotel.coords);
                    points.push(hotel.coords);

                    // Tasks
                    day.tasks.forEach((t, i) => {
                        if(t.coords) {
                            L.marker(t.coords, {
                                icon: L.divIcon({html: `<div>${i+1}</div>`, className: 'pin-std', iconSize: [24,24]})
                            }).addTo(this.layerGroup);
                            bounds.push(t.coords);
                            points.push(t.coords);
                        }
                    });

                    // Line
                    if(points.length > 1) {
                        L.polyline(points, {color: '#00f3ff', weight: 3, opacity: 0.6, dashArray: '5, 10'}).addTo(this.layerGroup);
                    }

                    if(bounds.length > 0) {
                        this.map.flyToBounds(bounds, {padding: [50, 50], duration: 1});
                    }
                },

                toggleTask(dayId, idx) {
                    const day = this.days.find(d => d.id === dayId);
                    day.tasks[idx].expanded = !day.tasks[idx].expanded;
                    // Force refresh (AlpineJS reactivity trick if needed, usually auto)
                },

                nav(coords) {
                    window.open(`https://www.google.com/maps/dir/?api=1&destination=${coords[0]},${coords[1]}&travelmode=transit`, '_blank');
                },

                locateMe() {
                    if(navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(p => {
                            const loc = [p.coords.latitude, p.coords.longitude];
                            L.circleMarker(loc, {radius: 8, color: '#39ff14', fillOpacity: 1}).addTo(this.layerGroup);
                            this.map.setView(loc, 14);
                        });
                    } else alert("W≈ÇƒÖcz GPS!");
                }
            }
        }
    </script>
</body>
</html>
